{% load static %}

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reportes CUT</title>
  
     <!-- * Favicon   -->
    <link rel="icon" href="/static/media/favicon.ico">
  
    <!-- ? Tailwind CSS   -->
    <script rel="stylesheet" src="https://cdn.tailwindcss.com?plugins=forms,typography,aspect-ratio,line-clamp"></script>
  
    <!-- ? Sweetalert CSS   -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.16/dist/sweetalert2.min.css">
  
    <!-- ? Datatables.net CSS   -->
    <link href="https://cdn.datatables.net/v/ju/jq-3.7.0/jszip-3.10.1/dt-1.13.6/b-2.4.2/b-html5-2.4.2/b-print-2.4.2/datatables.min.css" rel="stylesheet">

    <!-- ? Static CSS -->
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
  </head>
<body>

  <header>
    <nav class="bg-white border-gray-200 dark:bg-gray-900">
      <div class="max-w-screen-xl flex flex-wrap items-center justify-between mx-auto p-4">

        {% if user.is_authenticated %}
        <a href="{% url 'inicio' %}" class="flex items-center">
          <img src="/static/media/cut.png" class="h-10 mr-3" alt="CUT Logo">
          <span class="self-center text-2xl font-semibold whitespace-nowrap dark:text-white">Reportes CUT</span>
        </a>
        {% else %}
        <a href="{% url 'login' %}" class="flex items-center">
          <img src="/static/media/cut.png" class="h-10 mr-3" alt="CUT Logo">
          <span class="self-center text-2xl font-semibold whitespace-nowrap dark:text-white">Reportes CUT</span>
        </a>
        {% endif %}

        <button data-collapse-toggle="navbar-sticky" type="button" class="inline-flex items-center p-2 w-10 h-10 justify-center text-sm text-gray-500 rounded-lg md:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="navbar-sticky" aria-expanded="false">
          <span class="sr-only">Open main menu</span>
          <svg class="w-5 h-5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 17 14">
            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M1 1h15M1 7h15M1 13h15"/>
          </svg>
        </button>
        <div class="items-center justify-between hidden w-full md:flex md:w-auto md:order-1" id="navbar-sticky">
          <ul class="font-medium flex flex-col p-4 md:p-0 mt- border border-gray-100 rounded-lg bg-gray-50 md:flex-row md:space-x-8 md:mt-0 md:border-0 md:bg-white dark:bg-gray-800 md:dark:bg-gray-900 dark:border-gray-700">
            {% if user.is_authenticated %}
            <li>
              <a href="{% url 'profile' %}" class="block py-2 pl-3 pr-4 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:hover:text-blue-700 md:p-0 md:dark:hover:text-blue-500 dark:text-white dark:hover:bg-gray-700 dark:hover:text-white md:dark:hover:bg-transparent dark:border-gray-700">Perfil</a>
            </li>

            <li>
              <a href="{% url 'inicio' %}" class="block py-2 pl-3 pr-4 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:hover:text-blue-700 md:p-0 md:dark:hover:text-blue-500 dark:text-white dark:hover:bg-gray-700 dark:hover:text-white md:dark:hover:bg-transparent dark:border-gray-700">Servicios</a>
            </li>

            {% if user.is_staff or user.is_superuser %}
            <li>
              <a href="{% url 'register_user' %}" class="block py-2 pl-3 pr-4 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:hover:text-blue-700 md:p-0 md:dark:hover:text-blue-500 dark:text-white dark:hover:bg-gray-700 dark:hover:text-white md:dark:hover:bg-transparent dark:border-gray-700">Registrar</a>
            </li>
            {% endif %}
            
            <li>
              <a href="{% url 'about' %}" class="block py-2 pl-3 pr-4 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:hover:text-blue-700 md:p-0 md:dark:hover:text-blue-500 dark:text-white dark:hover:bg-gray-700 dark:hover:text-white md:dark:hover:bg-transparent dark:border-gray-700">About</a>
            </li>
            
            <li>
              <a id="logout" style="cursor: pointer;" class="block py-2 pl-3 pr-4 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:hover:text-red-700 md:p-0 md:dark:hover:text-red-700 dark:text-white dark:hover:bg-red-700 dark:hover:text-white md:dark:hover:bg-transparent dark:border-gray-700">Cerrar Sesion<i class="fa-solid fa-right-from-bracket pl-4"></i></a>
            </li>
            
            {% else %}

            <li>
              <a href="{% url 'about' %}" class="block py-2 pl-3 pr-4 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:hover:text-blue-700 md:p-0 md:dark:hover:text-blue-500 dark:text-white dark:hover:bg-gray-700 dark:hover:text-white md:dark:hover:bg-transparent dark:border-gray-700">About</a>
            </li>

            <li>
              <a href="{% url 'login' %}" class="block py-2 pl-3 pr-4 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:hover:text-blue-700 md:p-0 md:dark:hover:text-blue-500 dark:text-white dark:hover:bg-gray-700 dark:hover:text-white md:dark:hover:bg-transparent dark:border-gray-700">Iniciar Sesion</a>
            </li>

            {% endif %}
          </ul>
        </div>
      </div>
    </nav>
  </header>
  
  <div class="py-14 p-4">
    {% block content %} {% endblock content %}
  </div>
  
  <!-- TODO FontAwesome -->
  <script src="https://kit.fontawesome.com/12d7ab927d.js" crossorigin="anonymous"></script>
  
  <!-- TODO Tailwind JS -->
  <!-- <script src="https://cdn.tailwindcss.com/"></script> -->
  <script src="https://flowbite.com/docs/docs.js?v=1.8.1a"></script>
  <script src="https://flowbite.com/docs/datepicker.min.js?v=1.8.1a"></script>
  <script src="https://flowbite.com/docs/flowbite.min.js?v=1.8.1a"></script>
  
  <!-- TODO SweetAlert2 -->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.16/dist/sweetalert2.all.min.js"></script>
  
  <!-- TODO jQuery -->
  <script src="https://code.jquery.com/jquery-3.7.0.js"></script>
  
  <!-- TODO Datatables.net JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/pdfmake.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/vfs_fonts.js"></script>
  <script src="https://cdn.datatables.net/v/ju/jq-3.7.0/jszip-3.10.1/dt-1.13.6/b-2.4.2/b-html5-2.4.2/b-print-2.4.2/datatables.min.js"></script>

  <script>
    $('#example').DataTable({
      pagin: true,
      pageLenght: 10,
      lengthChange: false,
      searching: true,
      autoWidth: true,
      bInfo: true,
      bSort: false,
      deferRender: false,
      scroller: true,
      responsive: true,
      language: {
        "url": "https://cdn.datatables.net/plug-ins/1.13.6/i18n/es-ES.json"
      },
      dom: 'lBfrtip',
      buttons: [
        {
          extend: 'copy',
          text: '<i class="fa-solid fa-copy fa-lg"></i>',
          className: 'mb-2 inline-flex items-center justify-center w-10 h-10 mr-2 text-indigo-100 transition-colors duration-150 bg-indigo-700 rounded-lg focus:shadow-outline hover:bg-indigo-800',
          titleAttr: 'Copiar',
        },
        {
          extend: 'excel',
          text: '<i class="fa-solid fa-file-excel fa-lg"></i>',
          className: 'inline-flex items-center justify-center w-10 h-10 mr-2 text-indigo-100 transition-colors duration-150 bg-indigo-700 rounded-lg focus:shadow-outline hover:bg-indigo-800',
          titleAttr: 'Excel',
        },
        {
          extend: 'print',
          text: '<i class="fa-solid fa-print fa-lg"></i>',
          className: 'inline-flex items-center justify-center w-10 h-10 mr-2 text-indigo-100 transition-colors duration-150 bg-indigo-700 rounded-lg focus:shadow-outline hover:bg-indigo-800',
          titleAttr: 'Imprimir',
          exportOptions: {
            columns: [0, 1, 2, 3, 4, 5, 6, 7]
          },
          customize: function(win){
            $(win.document.body).css('font-size', '10pt')
            $(win.document.body).find('table')
              .addClass('compact')
              .css('font-size', 'inherit')
            
          }
        },
        {
          extend: 'pdf',
          text: '<i class="fa-solid fa-file-pdf fa-lg"></i>',
          className: 'inline-flex items-center justify-center w-10 h-10 mr-2 text-indigo-100 transition-colors duration-150 bg-indigo-700 rounded-lg focus:shadow-outline hover:bg-indigo-800',
          titleAttr: 'pdf',
          exportOptions: {
            columns: [0, 1, 2, 3, 4, 5, 6, 7]
          },
          tableHeader: {
            alignment: 'center',
          },
          customize: function(doc){
            // doc.content.unshift({
            //   image: '/static/media/cut.png',
            //   width: 50,
            //   alignment: 'left'
            // });

            doc.styles.tableHeader.alignment = 'center';
            doc.styles.tableBodyOdd.alignment = 'center';
            doc.styles.tableBodyEven.alignment = 'center';
            doc.styles.tableHeader.fontSize = 8;
            doc.defaultStyle.fontSize = 7;
            doc.content[1].table.widths = Array(doc.content[1].table.body[1].length + 1).join('*').split('');
          },
        },

      ]
    })

    var newSearch = $("#example").DataTable()
    $('#search').keyup(function() {
      newSearch.search($(this).val()).draw()
    })

  document.getElementById('logout').addEventListener('click', function(event) {
    event.preventDefault()

    Swal.fire({
      icon: 'question',
      title: '¿Desea cerrar sesion?',
      showCancelButton: true,
      confirmButtonColor: '#3085d6',
      cancelButtonColor: '#d33',
      confirmButtonText: 'Sí, cerrar sesión'
    }).then((result) => {
      if (result.isConfirmed) {
        window.location.href = '{% url "logout" %}'
      }
    })
  })
  </script>

</body>
</html>